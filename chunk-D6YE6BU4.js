import{a as x,b as d,c as _,d as S,e as M,g as F,h as O,n as k,o as E}from"./chunk-5G5EFX5T.js";import{a as v}from"./chunk-AASM5JO7.js";import"./chunk-LB3TK5W2.js";import{B as s,E as g,I as u,L as w,P as l,T as e,U as t,V as m,X as f,Y as h,aa as r,ba as b,ca as y,pa as C,q as p,ya as P}from"./chunk-NXQ7BON5.js";function z(n,o){n&1&&(e(0,"span",11),r(1,"At least 6 characters"),t())}function A(n,o){if(n&1&&(e(0,"p",14),r(1),t()),n&2){let a=h();s(),b(a.error)}}function T(n,o){n&1&&(e(0,"p",15),r(1,"Password changed. Use your new password next time you log in."),t())}var N=class n{auth=p(v);fb=p(k);passwordForm;error="";success=!1;loading=!1;constructor(){this.passwordForm=this.fb.group({currentPassword:["",d.required],newPassword:["",[d.required,d.minLength(6)]],confirmPassword:["",d.required]})}changePassword(){this.error="",this.success=!1;let o=this.passwordForm.getRawValue();if(this.passwordForm.invalid||o.newPassword!==o.confirmPassword){this.error=o.newPassword!==o.confirmPassword?"New passwords do not match.":"Please fill all fields; new password must be at least 6 characters.";return}this.loading=!0,this.auth.changePassword(o.currentPassword,o.newPassword).subscribe({next:()=>{this.success=!0,this.passwordForm.reset(),this.loading=!1,setTimeout(()=>this.success=!1,3e3)},error:a=>{this.error=a.error?.error??"Failed to change password.",this.loading=!1}})}static \u0275fac=function(a){return new(a||n)};static \u0275cmp=g({type:n,selectors:[["app-account-security"]],decls:27,vars:6,consts:[[1,"account-security-page"],[1,"page-title"],[1,"page-intro"],["aria-labelledby","password-heading",1,"security-card"],["id","password-heading",1,"section-heading"],[1,"section-intro"],[3,"ngSubmit","formGroup"],["for","currentPassword",1,"label"],["id","currentPassword","type","password","formControlName","currentPassword","placeholder","Current password","autocomplete","current-password",1,"input"],["for","newPassword",1,"label"],["id","newPassword","type","password","formControlName","newPassword","placeholder","New password (min 6 characters)","autocomplete","new-password",1,"input"],[1,"hint"],["for","confirmPassword",1,"label"],["id","confirmPassword","type","password","formControlName","confirmPassword","placeholder","Confirm new password","autocomplete","new-password",1,"input"],["role","alert",1,"hint"],[1,"save-hint"],["type","submit",1,"btn","btn-primary",3,"disabled"],["routerLink","/manage",1,"back-link"]],template:function(a,i){if(a&1&&(e(0,"div",0)(1,"h1",1),r(2,"Account Security"),t(),e(3,"p",2),r(4,"Reset your password. This applies only to your account."),t(),e(5,"section",3)(6,"h2",4),r(7,"Change password"),t(),e(8,"p",5),r(9,"Enter your current password, then choose a new one. Your new password must be at least 6 characters."),t(),e(10,"form",6),f("ngSubmit",function(){return i.changePassword()}),e(11,"label",7),r(12,"Current password"),t(),m(13,"input",8),e(14,"label",9),r(15,"New password"),t(),m(16,"input",10),u(17,z,2,0,"span",11),e(18,"label",12),r(19,"Confirm new password"),t(),m(20,"input",13),u(21,A,2,1,"p",14)(22,T,2,0,"p",15),e(23,"button",16),r(24),t()()(),e(25,"a",17),r(26,"\u2190 Back to Manage"),t()()),a&2){let c;s(10),w("formGroup",i.passwordForm),s(7),l((c=i.passwordForm.get("newPassword"))!=null&&c.invalid&&((c=i.passwordForm.get("newPassword"))!=null&&c.touched)?17:-1),s(4),l(i.error?21:-1),s(),l(i.success?22:-1),s(),w("disabled",i.passwordForm.invalid||i.loading),s(),y(" ",i.loading?"Updating\u2026":"Update password"," ")}},dependencies:[C,P,E,M,x,_,S,F,O],styles:[".account-security-page[_ngcontent-%COMP%]{padding:1.5rem 1.25rem 5rem;max-width:560px;margin:0 auto}.page-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:var(--text-primary);margin:0 0 .5rem}.page-intro[_ngcontent-%COMP%]{color:var(--text-secondary);margin:0 0 1.5rem;font-size:.95rem;line-height:1.5}.security-card[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:16px;border:1px solid var(--border);box-shadow:var(--shadow);padding:1.25rem 1.25rem 1.5rem;margin-bottom:1.5rem}.section-heading[_ngcontent-%COMP%]{font-size:1.05rem;font-weight:600;color:var(--text-primary);margin:0 0 .5rem;line-height:1.35}.section-intro[_ngcontent-%COMP%]{font-size:.9rem;color:var(--text-secondary);line-height:1.5;margin:0 0 1rem}.label[_ngcontent-%COMP%]{display:block;font-size:.9rem;font-weight:500;color:var(--text-primary);margin-bottom:.25rem}.input[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;margin-bottom:.75rem;border:1px solid var(--border);border-radius:10px;font-size:1rem;background:var(--bg-content);color:var(--text-primary);box-sizing:border-box}.input[_ngcontent-%COMP%]::placeholder{color:var(--text-secondary)}.hint[_ngcontent-%COMP%]{display:block;font-size:.8rem;color:var(--error-red);margin-bottom:.5rem}.save-hint[_ngcontent-%COMP%]{font-size:.9rem;color:var(--text-secondary);margin:.5rem 0 1rem}.btn[_ngcontent-%COMP%]{padding:.75rem 1rem;border:none;border-radius:10px;font-size:.95rem;font-weight:600;cursor:pointer;margin-top:.25rem}.btn-primary[_ngcontent-%COMP%]{background:var(--accent-blue);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){opacity:.9}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.back-link[_ngcontent-%COMP%]{display:inline-block;color:var(--accent-blue);text-decoration:none;font-size:.95rem}.back-link[_ngcontent-%COMP%]:hover{text-decoration:underline}"]})};export{N as AccountSecurityComponent};
