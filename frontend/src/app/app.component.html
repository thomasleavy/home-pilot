<div class="app-shell">
  @if (showShell) {
  <header class="app-header">
    <div class="header-top">
      <span class="time">{{ now() | date:'HH:mm' }}</span>
      <div class="theme-dial" role="group" aria-label="Theme">
        <button
          type="button"
          class="theme-option"
          [class.active]="!(themeService.isDark())"
          (click)="themeService.setTheme('light')"
          aria-pressed="!(themeService.isDark())"
          aria-label="Light mode"
        >
          <span class="theme-icon" aria-hidden="true">☀</span>
        </button>
        <button
          type="button"
          class="theme-option"
          [class.active]="themeService.isDark()"
          (click)="themeService.setTheme('dark')"
          [attr.aria-pressed]="themeService.isDark()"
          aria-label="Dark mode"
        >
          <span class="theme-icon theme-icon-moon" aria-hidden="true">☽</span>
        </button>
      </div>
      <div class="connection" [class]="'connection-' + connectionStatus">
        <span class="connection-dot"></span>
        <span>{{ connectionLabel() }}</span>
      </div>
    </div>
    <div class="header-main">
      <h1 class="greeting">{{ greeting }}</h1>
    </div>
  </header>
  }
  <router-outlet></router-outlet>
  @if (showShell) {
  <nav class="bottom-nav" aria-label="Main navigation">
    <a routerLink="/home" class="nav-item" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">
      <span class="nav-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </span>
      <span class="nav-label">Home</span>
    </a>
    <a routerLink="/insights" class="nav-item" routerLinkActive="active">
      <span class="nav-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
      </span>
      <span class="nav-label">Insights</span>
    </a>
    <a routerLink="/discover" class="nav-item" routerLinkActive="active">
      <span class="nav-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"/></svg>
      </span>
      <span class="nav-label">Discover</span>
    </a>
    <a routerLink="/manage" class="nav-item" routerLinkActive="active">
      <span class="nav-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
      </span>
      <span class="nav-label">Manage</span>
    </a>
  </nav>
  }
  </div>
